@using System.Configuration;
@{
	var adminBaseUrl = ConfigurationManager.AppSettings["BaseUrl"].ToString();
	DateTime now = DateTime.Today;
}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link href="~/Scripts/Plugins/jquery.bootstrapvalidator/css/bootstrapValidator.min.css" rel="stylesheet" />
    <link href="~/Scripts/Plugins/datatables/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="~/Scripts/Plugins/bootstrap3-dialog/css/bootstrap-dialog.min.css" rel="stylesheet" />
    <link href="~/Scripts/Plugins/bootstrap-multiselect/css/bootstrap-multiselect.min.css" rel="stylesheet" />
    <link href="~/Scripts/Plugins/toastr.js/toastr.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Content/Admin/css/custom.css?v=@(DateTime.Now.Ticks)">
    <link href="~/Content/Admin/css/dev-custom.css?v=@(DateTime.Now.Ticks)" rel="stylesheet" />
    <link href="~/Content/Admin/css/loader.css" rel="stylesheet" />
    <link href="~/Content/favicon/favicon.png" rel="icon" type="image/png" sizes="32x32">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    
    <title>@ViewBag.Title | Mi Lunch Money</title>

    @if (IsSectionDefined("Styles"))
    {@RenderSection("Styles", required: false)}
</head>
<body>
    <div id="overlay">
        <div class="cv-spinner">
            <span class="spinner"></span>
        </div>
    </div>
    <div class="admincover">
        @Html.Partial("_Sidebar")
        @Html.Partial("_ProfilePartial")
        <div>&nbsp;</div>

        @RenderBody()
    </div>

    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>*@
    <script type="text/javascript" src="~/Scripts/signalR/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/signalR/jquery.signalR-2.1.1.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="/signalr/hubs"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    @*<script src="~/Scripts/Plugins/bootstrap/js/bootstrap.bundle.min.js"></script>*@
    <script src="~/Scripts/Plugins/jquery.bootstrapvalidator/js/bootstrapValidator.min.js"></script>
    <script src="~/Scripts/Plugins/datatables/js/jquery.dataTables.min.js"></script>
    <script src="~/Scripts/Plugins/bootstrap3-dialog/js/bootstrap-dialog.min.js"></script>
    <script src="~/Scripts/Plugins/moment.js/moment.min.js"></script>
    <script src="~/Scripts/Plugins/toastr.js/toastr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/imask/6.0.7/imask.min.js" integrity="sha512-qCt/OTd55ilhuXLRNAp/G8uONXUrpFoDWsXDtyjV4wMbvh46dOEjvHZyWkvnffc6I2g/WHSKsaFUCm0RISxnzQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-analytics.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="~/Scripts/pages/common.script.js"></script>
    <script>
        //SignalR Initialization
        function setTotalNotification(totalNotif) {
            var tbl = $('#messagesTable');
            $.ajax({
                url: '/Notification/GetAllWebNotification',
                dataType: 'json',
                type: "GET",
                contentType: false,
                cache: false,
                processData: false,
                
                success: function (res) {
                    var response = res.data;
                    if (response.code == 200) {
                        if (response.data.result.length > 0) {
                            //for (var i = 0; i < response.data.result.length; i++) {
                            //    window.setTimeout(function () {
                            //        alert(response.data.result[i]);
                            //    }, 2000);
                            //}
                            $(response.data.result).each(function () {                                
                                toastr.success(this.Subject);
                            });
                            
                            
                        }
                        
                    } else {
                        toastr.error(response.message, "Error");
                    }
                },
                error: function (jqXHR) {
                    toastr.error(jqXHR.responseJSON.message, "Error");
                }
            }).done(function () {
                setTimeout(function () { $("#overlay").fadeOut(300); }, 500);
            });
          
            
        }

        var hub = $.connection.messagesHub;

        //Client Call
        hub.client.broadcaastNotif = function (totalNotif) {
            setTotalNotification(totalNotif)
        };

        $.connection.hub.start()
            .done(function () {
                console.log("Hub Connected!");
                setTotalNotification(1);
                //Server Call
                //hub.server.getNotification("","");

            })
            .fail(function () {
                console.log("Could not Connect!");
            });
        
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyB-3xAod4Gz_7UCD15mM1l6O5ECHNvfOLU",
            authDomain: "milunchmoney-c3e82.firebaseapp.com",
            projectId: "milunchmoney-c3e82",
            storageBucket: "milunchmoney-c3e82.appspot.com",
            messagingSenderId: "970822078643",
            appId: "1:970822078643:web:2e2884b425e4ae7abfa0c6",
            measurementId: "G-Y4N9LPBHC0"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        function openMenu() {
            $("div.burger-menu").toggleClass("open")
        }

        $(function () {
			window.adminBaseUrl = "@adminBaseUrl";
			window.defaultImageUrl = window.adminBaseUrl + "/img/default-user-black.svg";
			window.defaultItemImageUrl = "/Content/Admin/img/no-image.png";
        });

        function getAllMessages() {
            
        }
    </script>

    @RenderSection("scripts", required: false)
</body>
</html>
